<template id="todo-input">
  <input id="{{iid}}" class="edit" value="{{value}}" placeholder="{{placeholder}}" autofocus on-keyup="keyup" on-keypress="keypress">
</template>
<script>
  Nano({
    name: 'todo-input',
    sugar: {
      properties: ['value'],
      template: document.currentImport.querySelector('template#todo-input')
    },
    prototype: {
      __proto__: Polymer.BaseElement.prototype,
      createdCallback: function() {
        this.updateBindings('iid', this.getAttribute('inputid'));
        this.updateBindings('placeholder', this.getAttribute('placeholder'));
      },
      keyup: function(e) {
			  if (e.keyCode === 27 /*ESC*/) {
				  this.fire('todo-cancel');
			  }  
      },
      keypress: function(e) {
			  if (e.keyCode === 13 /*ENTER*/) {
          this.value = e.target.value.trim();;
				  this.fire('todo-commit', {value: this.value});
			  }  
      },
      focus: function() {
        this.$$('input').focus();
      },
      valueChanged: function(value) {
        this.updateBindings('value', value);
      }
    }
  });
</script>