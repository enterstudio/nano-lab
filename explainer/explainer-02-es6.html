<!doctype html>
<html>
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">

  <title>Explainer ES6</title>

  <style>
    body {
      font-family: sans-serif;
    }
  </style>
  
  <link rel="import" href="../components/polymer/polymer-nano.debug.html">
  <link rel="import" href="../components/nano-elements/nano-ripple.html">

</head>
<body>

  <h1>n&Aring;noPolymer</h1>

  <input is="x-foo-1">

  <style>
    [is=x-foo-1] {
      padding: 8px;
      border: none;
      border-bottom: 1px solid silver;
      margin-bottom: 1px;
    }
    [is=x-foo-1]:focus {
      outline: none;
      border-bottom: none;
    }
    [is=x-foo-1][focused] {
      border-bottom: 2px solid navy;
    }
  </style>
  
  <script>
   'use strict';

    class XFoo1 extends HTMLInputElement {
      createdCallback() {
        this.placeholder = 'I say, wot?';
        Nano.listen(this, ['keyup', 'keypress', 'focus', 'blur'], this);
        this.ripple = document.createElement('nano-ripple');
      }
      onKeyup(e) {
        if (e.keyCode === 27) {
          this.value = '';
        }
      }
      onKeypress(e) {
        if (e.keyCode === 13) {
          this.value = '';
        }
      }
      onFocus(e) {
        this.focused = true;
        var r = this.getBoundingClientRect();
        var wave = this.ripple.ripple(this, 0, 24, 'navy', {top: r.top + r.height - 1, left: r.left, height: 4, width: r.width});
        setTimeout(function() {
          wave.finish();
          this.updateFocusedState();
        }.bind(this), 200);
      }
      onBlur(e) {
        this.focused = false;
        this.updateFocusedState();
      }
      // purposefully stateful as this method is called asynchronously to afford animation delays
      updateFocusedState() {
        Nano.boolAttribute(this, 'focused', this.focused);
      }
    };

    XFoo1.extends = 'input';
    document.registerElement('x-foo-1', XFoo1);   
  </script>
  
  </body>
</html>
